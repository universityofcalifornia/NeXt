<% if context.user %>
<%= button_to 'Propose Idea',
              new_idea_url,
              method: :get,
              class: 'btn btn-warning btn-block',
              form_class: 'button_to pull-right' %>
<% end %>

<h2>Ideas</h2>

<%= will_paginate @ideas %>

<div class="list-group">
<% @ideas.each do |idea| %>
  <a class="list-group-item" href="<%= idea_url(idea) %>">
    <div class="row">
      <div class="col-sm-10">
        <h4><%= idea.name %></h4>
        <%= raw idea.pitch %>
        <p><small>
          Proposed
          <% if idea.idea_roles.founders.count > 0 %>
          by <strong><%= idea.idea_roles.founders.includes(:user).map(){ |r| r.user.display_name }.to_sentence %></strong>
          <% end %>
          on <strong><%= idea.created_at.strftime("%B %d, %Y") %></strong>
          <br>
          <em>Supported by <%= idea.idea_votes.count %> ( <%= idea.idea_votes.where(participate: true).count %> would participate )</em>
        </small></p>
      </div>
      <% unless idea.has_been_voted_for_by? context.user %>
        <nav class="col-sm-2 text-right-md text-right-lg">
          <%= button_to '+1', '#', class: 'btn btn-success modal-button', method: :get %>
          <%= render partial: "shared/modal_dialog", locals: {
            object: idea,
            button_text: [
              'I think this is a good idea',
              'I would participate if this were a project',
              'I want to learn more about this'
            ]
          } %>
        </nav>
      <% end %>
    </div>
  </a>
<% end %>
</div>

<%= will_paginate @ideas %>
